ggplot(data = acu, mapping = aes(x = pk1, y = pk5)) +
geom_point(mapping = aes(color = new), size = 2) +
xlab("baseline headache severity rating") +
ylab("1-year headache severity rating") +
ggtitle("pk1 vs pk5 (ggplot2)") +
guides(color = guide_legend(title = "aa"))
ggplot(data = acu, mapping = aes(x = pk1, y = pk5)) +
geom_point(mapping = aes(color = new), size = 2) +
scale_color_manual(values = c('0.0' = "blue",  '0.5' = "red", '1.0' = "purple",'1.5' = "green"))+
xlab("baseline headache severity rating") +
ylab("1-year headache severity rating") +
ggtitle("pk1 vs pk5 (ggplot2)") +
guides(color = guide_legend(title = "aa"))
ggplot(data = acu, mapping = aes(x = pk1, y = pk5)) +
geom_point(mapping = aes(color = new), size = 2) +
xlab("baseline headache severity rating") +
ylab("1-year headache severity rating") +
ggtitle("pk1 vs pk5 (ggplot2)") +
guides(color = guide_legend(title = "aa"))
cols <- factor(x = acu$new,
levels = c(0, 0.5, 1, 1.5),
labels = c("orange", "green", "blue", "purple"))
plot(acu$pk1, acu$pk5, main = "pk1 vs pk5 (R base)",
xlab = "baseline headache severity rating",
ylab = "1-year headache severity rating",
pch = 19,
cex = .9,
col = as.character(cols)
)
legend(x = "topright",
legend = c("Male+Controlgroup", "Female+Controlgroup", "Male+TreatmentGroup", "Female+TreatmentGroup"),
col = c("orange", "green", "blue", "purple"),
pch = 15, pt.cex = 1)
plot(acu$pk1, acu$pk5, main = "pk1 vs pk5 (R base)",
xlab = "baseline headache severity rating",
ylab = "1-year headache severity rating",
pch = 19,
cex = .9,
col = as.character(cols)
)
legend(x = "topright",
legend = c("Male+Controlgroup", "Female+Controlgroup", "Male+TreatmentGroup", "Female+TreatmentGroup"),
col = c("orange", "green", "blue", "purple"),
pch = 15, pt.cex = 1)
ggplot(data = acu, mapping = aes(x = pk1, y = pk5)) +
geom_point(mapping = aes(color = new), size = 2) +
xlab("baseline headache severity rating") +
ylab("1-year headache severity rating") +
ggtitle("pk1 vs pk5 (ggplot2)") +
guides(color = guide_legend(title = "aa"))
acu.loc[acu$new == 0, 'new'] = "asd"
df.loc[acu$new == 0, 'new'] = "asd"
acu
acu <- read.csv("C:/Users/tonyg/Desktop/Academic/Grad/HUDM 5026/acupuncture.csv")
acu$new <- 0.5*acu$sex+acu$group
acu$new[acu$new == 0] <- "Male+Controlgroup"
acu$new[acu$new == 0] <- "Male+Controlgroup"acu$new[acu$new == 0] <- "Male+Controlgroup"
acu$new[acu$new == 0] <- "Male+Controlgroup"
acu$new[acu$new == 0.5] <- "Female+Controlgroup"
acu$new[acu$new == 1] <- "Male+TreatmentGroup"
acu$new[acu$new == 1.5] <- "Female+TreatmentGroup"
acu
## Problem 10
```{r}
ggplot(data = acu, mapping = aes(x = pk1, y = pk5)) +
geom_point(mapping = aes(color = new), size = 2) +
xlab("baseline headache severity rating") +
ylab("1-year headache severity rating") +
ggtitle("pk1 vs pk5 (ggplot2)") +
guides(color = guide_legend(title = "Sex + Group"))
?geom_point
ggplot(data = acu, mapping = aes(x = pk1, y = pk5)) +
geom_point(mapping = aes(color = new), size = 2, shape = 5) +
xlab("baseline headache severity rating") +
ylab("1-year headache severity rating") +
ggtitle("pk1 vs pk5 (ggplot2)") +
guides(color = guide_legend(title = "Sex + Group"))
ggplot(data = acu, mapping = aes(x = pk1, y = pk5)) +
geom_point(mapping = aes(color = new), size = 2, shape = 1) +
xlab("baseline headache severity rating") +
ylab("1-year headache severity rating") +
ggtitle("pk1 vs pk5 (ggplot2)") +
guides(color = guide_legend(title = "Sex + Group"))
ggplot(data = acu, mapping = aes(x = pk1, y = pk5)) +
geom_point(mapping = aes(color = new), size = 2, shape = 2) +
xlab("baseline headache severity rating") +
ylab("1-year headache severity rating") +
ggtitle("pk1 vs pk5 (ggplot2)") +
guides(color = guide_legend(title = "Sex + Group"))
ggplot(data = acu, mapping = aes(x = pk1, y = pk5)) +
geom_point(mapping = aes(color = new), size = 2, shape = 3) +
xlab("baseline headache severity rating") +
ylab("1-year headache severity rating") +
ggtitle("pk1 vs pk5 (ggplot2)") +
guides(color = guide_legend(title = "Sex + Group"))
ggplot(data = acu, mapping = aes(x = pk1, y = pk5)) +
geom_point(mapping = aes(color = new), size = 2, shape = 4) +
xlab("baseline headache severity rating") +
ylab("1-year headache severity rating") +
ggtitle("pk1 vs pk5 (ggplot2)") +
guides(color = guide_legend(title = "Sex + Group"))
ggplot(data = acu, mapping = aes(x = pk1, y = pk5)) +
geom_point(mapping = aes(color = new), size = 2, shape = 6) +
xlab("baseline headache severity rating") +
ylab("1-year headache severity rating") +
ggtitle("pk1 vs pk5 (ggplot2)") +
guides(color = guide_legend(title = "Sex + Group"))
ggplot(data = acu, mapping = aes(x = pk1, y = pk5)) +
geom_point(mapping = aes(color = new), size = 2, shape = 7) +
xlab("baseline headache severity rating") +
ylab("1-year headache severity rating") +
ggtitle("pk1 vs pk5 (ggplot2)") +
guides(color = guide_legend(title = "Sex + Group"))
ggplot(data = acu, mapping = aes(x = pk1, y = pk5)) +
geom_point(mapping = aes(color = new), size = 2, shape = 8) +
xlab("baseline headache severity rating") +
ylab("1-year headache severity rating") +
ggtitle("pk1 vs pk5 (ggplot2)") +
guides(color = guide_legend(title = "Sex + Group"))
ggplot(data = acu, mapping = aes(x = pk1, y = pk5)) +
geom_point(mapping = aes(color = new), size = 2, shape = 9) +
xlab("baseline headache severity rating") +
ylab("1-year headache severity rating") +
ggtitle("pk1 vs pk5 (ggplot2)") +
guides(color = guide_legend(title = "Sex + Group"))
ggplot(data = acu, mapping = aes(x = pk1, y = pk5)) +
geom_point(mapping = aes(color = new), size = 2, shape = 10) +
xlab("baseline headache severity rating") +
ylab("1-year headache severity rating") +
ggtitle("pk1 vs pk5 (ggplot2)") +
guides(color = guide_legend(title = "Sex + Group"))
ggplot(data = acu, mapping = aes(x = pk1, y = pk5)) +
geom_point(mapping = aes(color = new), size = 2, shape = 11) +
xlab("baseline headache severity rating") +
ylab("1-year headache severity rating") +
ggtitle("pk1 vs pk5 (ggplot2)") +
guides(color = guide_legend(title = "Sex + Group"))
ggplot(data = acu, mapping = aes(x = pk1, y = pk5)) +
geom_point(mapping = aes(color = new), size = 2, shape = 12) +
xlab("baseline headache severity rating") +
ylab("1-year headache severity rating") +
ggtitle("pk1 vs pk5 (ggplot2)") +
guides(color = guide_legend(title = "Sex + Group"))
ggplot(data = acu, mapping = aes(x = pk1, y = pk5)) +
geom_point(mapping = aes(color = new), size = 2, shape = 13) +
xlab("baseline headache severity rating") +
ylab("1-year headache severity rating") +
ggtitle("pk1 vs pk5 (ggplot2)") +
guides(color = guide_legend(title = "Sex + Group"))
ggplot(data = acu, mapping = aes(x = pk1, y = pk5)) +
geom_point(mapping = aes(color = new), size = 2, shape = 14) +
xlab("baseline headache severity rating") +
ylab("1-year headache severity rating") +
ggtitle("pk1 vs pk5 (ggplot2)") +
guides(color = guide_legend(title = "Sex + Group"))
ggplot(data = acu, mapping = aes(x = pk1, y = pk5)) +
geom_point(mapping = aes(color = new), size = 2, shape = 15) +
xlab("baseline headache severity rating") +
ylab("1-year headache severity rating") +
ggtitle("pk1 vs pk5 (ggplot2)") +
guides(color = guide_legend(title = "Sex + Group"))
colnames(acu)
?read.csv
acu <- read.csv("C:/Users/tonyg/Desktop/Academic/Grad/HUDM 5026/acupuncture.csv",header = TRUE)
apply(X = acu, MARGIN = 2, FUN = sd)
cols <- factor(x = acu$new,
levels = c(0, 0.5, 1, 1.5),
labels = c("blue", "orange", "purple", "green"))
plot(acu$pk1, acu$pk5, main = "pk1 vs pk5 (R base)",
xlab = "baseline headache severity rating",
ylab = "1-year headache severity rating",
pch = 19,
cex = .9,
col = as.character(cols)
)
legend(x = "topright",
legend = c("Male+Controlgroup", "Female+Controlgroup", "Male+TreatmentGroup", "Female+TreatmentGroup"),
col = c("blue", "orange", "purple", "green"),
pch = 15, pt.cex = 1)
plot(acu$pk1, acu$pk5, main = "pk1 vs pk5 (R base)",
xlab = "baseline headache severity rating",
ylab = "1-year headache severity rating",
pch = 19,
cex = .9,
col = as.character(cols)
)
legend(x = "topright",
legend = c("Male+Controlgroup", "Female+Controlgroup", "Male+TreatmentGroup", "Female+TreatmentGroup"),
col = c("blue", "orange", "purple", "green"),
pch = 15, pt.cex = 1)
cols <- factor(x = acu$new,
levels = c(0, 0.5, 1, 1.5),
labels = c("blue", "orange", "purple", "green"))
plot(acu$pk1, acu$pk5, main = "pk1 vs pk5 (R base)",
xlab = "baseline headache severity rating",
ylab = "1-year headache severity rating",
pch = 19,
cex = .9,
col = as.character(cols)
)
legend(x = "topright",
legend = c("Male+Controlgroup", "Female+Controlgroup", "Male+TreatmentGroup", "Female+TreatmentGroup"),
col = c("blue", "orange", "purple", "green"),
pch = 15, pt.cex = 1)
plot(acu$pk1, acu$pk5, main = "pk1 vs pk5 (R base)",
xlab = "baseline headache severity rating",
ylab = "1-year headache severity rating",
pch = 19,
cex = .9,
col = as.character(cols)
)
legend(x = "topright",
legend = c("Male+Controlgroup", "Female+Controlgroup", "Male+TreatmentGroup", "Female+TreatmentGroup"),
col = c("blue", "orange", "purple", "green"),
pch = 15, pt.cex = 1)
knitr::opts_chunk$set(echo = TRUE)
x <- rnorm(100)
y <- x + x ^ 2 + rnorm(100)
par(mfrow = c(1, 2))
hist(x)
hist(y)
par(mfrow = c(1, 2))
hist(x)
hist(y)
par(mfrow = c(1, 2))
fit1 <- lm(y ~ x)
fit2 <- lm(y ~ x + I(x ^ 2))
anova(fit1, fit2)
par(mfrow = c(1, 2))
hist(x)
hist(y)
anova(mod1)
?anova
anova(mod1, mod2)
mod1 <- lm(y ~ x)
mod2 <- lm(y ~ x + I(x ^ 2))
anova(mod1ï¼‰
anova(mod1)
anova(mod2)
anova(mod1)
anova(mod1, mod2)
I(x^2)
?I
read.csv("C:/Users/tonyg/Desktop/Academic/Grad/HUDM 5126/AdRevenue.csv")
adr<-read.csv("C:/Users/tonyg/Desktop/Academic/Grad/HUDM 5126/AdRevenue.csv")
lm(AdRevenue ~ Circulation, data = adRevenue)
lm(AdRevenue ~ Circulation, data = adr)
mod1<-lm(AdRevenue ~ Circulation, data = adr)
plot(mod1)
par(2,2)
plot(mod1)
knitr::opts_chunk$set(echo = TRUE)
acu <- read.csv("C:/Users/tonyg/Desktop/Academic/Grad/HUDM 5026/decath.csv")
is.tibble(acu)
library(tidyverse)
dec <- read.csv("C:/Users/tonyg/Desktop/Academic/Grad/HUDM 5026/decath.csv")
is.tibble(dec)
is_tibble(dec)
dec
print(dec)
print(dec)
?print
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
apply(X = dec, MARGIN = 2, FUN = mean)
apply(X = dec, MARGIN = 2, FUN = sd)
cov(dec)
round(cov(dec),2)
round(cor(dec),2)
round(cov(dec),2)
round(cor(dec),2)
round(cov(dec),2)
round(cor(dec),2)
intall.package("corrplot")
intall.packages("corrplot")
install.packages("corrplot")
library(corrplot)
corrplot(acu)
corrplot(cor(dec))
corrplot(cor(dec),order = "hclust")
corrplot(cor(dec), order = "hclust")
```{r}
round(cor(dec),2)
plot(dec$disq, dec$poid, main = "discus vs shot put (R base)",
xlab = "baseline headache severity rating",
ylab = "1-year headache severity rating")
plot(dec$poid, dec$jave, main = "shot put vs javelin (R base)",
xlab = "Scores for shot put",
ylab = "Scores for javelin")
plot(dec$disq, dec$jave, main = "discus vs javelin (R base)",
xlab = "Scores for discus",
ylab = "Scores for javelin")
hist(poid, main = "shot put vs javelin (R base)",
xlab = "Scores for shot put",
ylab = "Scores for javelin")
hist(dec$poid, main = "shot put vs javelin (R base)",
xlab = "Scores for shot put",
ylab = "Scores for javelin")
par(mfrow = c(2,2))
a
b
a <- plot(dec$disq, dec$poid, main = "discus vs shot put (R base)",
xlab = "Scores for discus",
ylab = "Scores for shot put")
a
par(mfrow = c(2,2))
plot(dec$disq, dec$poid, main = "discus vs shot put (R base)",
xlab = "Scores for discus",
ylab = "Scores for shot put")
plot(dec$poid, dec$jave, main = "shot put vs javelin (R base)",
xlab = "Scores for shot put",
ylab = "Scores for javelin")
plot(dec$disq, dec$jave, main = "discus vs javelin (R base)",
xlab = "Scores for discus",
ylab = "Scores for javelin")
hist(dec$poid, main = "shot put Histogram (R base)",
xlab = "Scores for shot put",
ylab = "Count")
install.packages("ggExtra")
library(ggExtra)
?ggMarginal
p1 <- ggplot(data = dec, mapping = aes(x = disq, y = poid)) +
geom_point() +
xlab("Scores for discus") +
ylab("Scores for shot pu") +
theme(legend.position = "none")
ggMarginal(p1, type = "density")
p1 <- ggplot(data = dec, mapping = aes(x = disq, y = poid)) +
geom_point() +
xlab("Scores for discus") +
ylab("Scores for shot put")
ggMarginal(p1, type = "density")
p1 <- ggplot(data = Salaries, mapping = aes(x = yrs.since.phd, y = salary)) +
geom_point() +
xlab("Years since PhD") +
ylab("Annual salary ($)") +
theme(legend.position = "none")
p1 <- ggplot(data = dec, mapping = aes(x = disq, y = poid)) +
geom_point() +
xlab("Scores for discus") +
ylab("Scores for shot put") +
theme(legend.position = "none")
ggMarginal(p1, type = "density")
acu <- read.csv("C:/Users/tonyg/Desktop/Academic/Grad/HUDM 5026/acupuncture.csv", header = TRUE)
acu
acu[,1]
acu[
order( acu[,7], acu[,3], acu[,2] ),
]
acu [
order( acu$`group`, acu$`sex`, acu$`age`)
]
acu [
order(acu$`group`, acu$`sex`, acu$`age`)
]
acu[
order(acu$`group`, acu$`sex`, acu$`age`)
]
acu[
order(acu$group, acu$sex, acu$age)
]
acu[
order(acu$group, acu$sex, acu$age),
]
acu[
order( acu[,7], acu[,3], acu[,2] ),
]
acu[
order(acu$group, acu$sex, acu$age),
]
acu[
order( acu[,7], acu[,3], acu[,2] ),
]
acu[
order(acu$group, acu$sex, acu$age),
]
acu3 <- acu[acu$age > 30]
acu3 <- acu[acu$age > 30,]
acu3
acu
acu3
acu4 <- acu[acu$pk1 >= 40]
acu4 <- acu[acu$pk1 >= 40, ]
acu4
acu[which(acu$sex == 1 & acu$age >= 40), ]
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(ggExtra)
acu3 <- subset(acu, group == 1 & age > 30)
acu3
fourty_percentile <- quantile(acu$pk1, c(0.4))
fourty_percentile
acu4 <- sebset[acu, pk1 >= fourty_percentile]
acu4 <- sebset(acu, pk1 >= fourty_percentile)
acu3 <- subset(acu, group == 1 & age > 30)
acu %>%
select( group == 1 & age > 30)
# 13.4 Mutating joins
# Create a subset of the data
flights2 <- flights %>%
select(year:day, hour, origin, dest, tailnum, carrier)
library(tidyverse)
library(ggExtra)
acu4 <- sebset(acu, pk1 >= fourty_percentile)
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(ggExtra)
acu <- read.csv("C:/Users/tonyg/Desktop/Academic/Grad/HUDM 5026/acupuncture.csv", header = TRUE)
acu2 <- acu[
order(acu$group, acu$sex, acu$age),
]
acu3 <- subset(acu, group == 1 & age > 30)
fourty_percentile <- quantile(acu$pk1, c(0.4))
acu4 <- sebset(acu, pk1 >= fourty_percentile)
acu3 <- subset(acu, group == 1 & age > 30)
acu4 <- sebset(acu, pk1 >= fourty_percentile)
acu4 <- subset(acu, pk1 >= fourty_percentile)
print(dec, n = Inf, width = 300)
dec <- read.csv("C:/Users/tonyg/Desktop/Academic/Grad/HUDM 5026/decath.csv")
is.tibble(dec)
print(dec, n = Inf, width = 300)
?print
print(dec, max.levels = NULL, width = 300)
print(dec, max.levels = NULL, n = Inf, width = 300)
playbill <- read.csv('C:/Users/tonyg/Desktop/Academic/Grad/HUDM 5126/playbill.csv')
indicators <- read.table(file='C:/Users/tonyg/Desktop/Academic/Grad/HUDM 5126/indicators.txt',header = TRUE)
invoices <- read.table(file='C:/Users/tonyg/Desktop/Academic/Grad/HUDM 5126/invoices.txt',header = TRUE)
fit1 <- lm(CurrentWeek ~ LastWeek, data = playbill)
summary(fit1)
confint(fit1)[2, ]
confint(fit1)
?confint
confint(fit1)[2, ]
confint(fit1, level = .9)[2, ]
t.test(playbill$LastWeek,mu=10000)
?knitr
t.test(playbill$LastWeek,mu=10000)
t.test(playbill$LastWeek,mu=10000)
summary(fit1)$coef[1, 2]
b <- coef(fit1)[[1]]
b1 <- b + coef(fit1)[[2]] * 10000
se <- summary(fit1)$coef[1, 2]
t <- (b - b1) / se
t>qt(p=0.05, nrow(playbill) - 2, lower.tail = FALSE)
t
t_stat = (coef(summ)['(Intercept)', 'Estimate'] - 10000)/coef(summ)['(Intercept)', 'Std. Error']
summary(fit1)$coef[1, 2]
coef(summary(fit1))['(Intercept)', 'Estimate']
?rnorm
rnorm(200,2,2)
I(x ^ 2)
?I
knitr::opts_chunk$set(echo = TRUE)
library(lmtest)
adjmod1 <- lm(AdRevenue ~ sqrt(Circulation), data = adr)
adjmod2 <- lm(sqrt(AdRevenue) ~ Circulation, data = adr)
adjmod3 <- lm(AdRevenue ~ Circulation, data = adr)
Adjmod4 <- lm(AdRevenue ^ (1/3) ~ Circulation, data = adr)
bptest(adjmod1)$p.value
bptest(adjmod1)
set.seed(5126)
shapiro.test(resid(adjmod2))$p.value
shapiro.test(resid(Adjmod4))$p.value
shapiro.test(resid(adjmod2))
aov(Adjmod4)
aov(AdRevenue ^ (1/3) ~ Circulation, data = adr)
summary(aov(AdRevenue ^ (1/3) ~ Circulation, data = adr))
anova(adjmod1, Adjmod4)
adjmod1 <- lm(AdRevenue ~ sqrt(Circulation), data = adr)
adjmod2 <- lm(sqrt(AdRevenue) ~ Circulation, data = adr)
adjmod3 <- lm(AdRevenue ~ Circulation, data = adr)
Adjmod4 <- lm(AdRevenue ^ (1/3) ~ Circulation, data = adr)
summary(aov(AdRevenue ^ (1/3) ~ Circulation, data = adr))
anova(adjmod1, Adjmod4)
anova(adjmod1, adjmod2)
pairs(adr[,1:4], pch = 19)
adr
pairs(adr[,13:4], pch = 19)
pairs(adr[,3:4], pch = 19)
knitr::opts_chunk$set(echo = TRUE)
setwd("C:/Users/tonyg/Desktop/Academic/Grad/HUDM 5126")
salary <- read.table("ProfessorSalaries.txt", header = TRUE)
attach(salary)
StdDev
setwd("C:/Users/tonyg/Desktop/Academic/Grad/HUDM 5126")
salary <- read.table("ProfessorSalaries.txt", header = TRUE)
attach(salary)
StdDev
cleaningwtd <- read.table("cleaningwtd.txt",header=TRUE)
cleaningwtd
salary
sd(cleaningwtd$Rooms)
mean(cleaningwtd$Rooms)
51-33.90566
mean(cleaningwtd$Crews)
16-mean(cleaningwtd$Crews)
cleaningwtd
sum(cleaningwtd$Rooms)
mean(cleaningwtd$Rooms)
mean(cleaningwtd$Crews)
16-mean(cleaningwtd$Crews)
attach(cleaningwtd)
StdDev
wm1 <- lm(Rooms~Crews)
summary(wm1)
fitted(wm1)
1 / lm(abs(wm1$residuals) ~ wm1$fitted.values)$fitted.values^2
wt<-1 / lm(abs(wm1$residuals) ~ wm1$fitted.values)$fitted.values^2
wt<-lm(abs(wm1$residuals) ~ wm1$fitted.values)$fitted.values
wt
wt<-lm(abs(wm1$residuals) ~ wm1$fitted.values)$fitted.values
wt
